dist: xenial
before_install:
- bash install/helm_kubeval_install.sh
script:
- helm lint charts/todo-app
- mkdir manifests
- helm template charts/todo-app --output-dir manifests
- bash scripts/kubeval_validate_manifest.sh
after_success:
- mkdir distribution
- helm package charts/todo-app --destination distribution/
- helm repo index --url $GITHUB_PAGES_URL/todo-app-helm-chart ./distribution/
deploy:
  provider: pages
  skip_cleanup: true
  github_token: "$GITHUB_TOKEN"
  keep_history: true
  local_dir: "./distribution"
  on:
    branch: master
env:
  global:
    secure: uYPRyoJVVWFNotUyRHyPubMDPWiD1GgtHJ+vjqq5vDJTb4V9m/lWPeFj10PNJWP4c+phKBXpRPGjUX1dFtANqviboouNZ5buqQLudDdWLqNCryjj893R4VmPBqADbPgsDhUBDytj/rX2uiy4JUzys7u1z15vW5njKhXsrAW1QnBdyu541SooQT/OJQx0rlNhSNDpXNZVOUtFDsEQAPaRDt2CrLKIrEx4m5GO1Pvws4vERVByKbTaN3aqrC5zDkpraRcJ7kqHxuI71x5l72n6cmiy6hINRFaKBc5vQqIduMoAtysjgoxvYpm4Z3wlUfT+vBg2wS9lWpsVgNFzU5x6pj79BK2V6r5PD21Xgf1vX9IeWm4VB7nFEsMXVy/Kf9anGcELSa8zbO4vqNoPDWRVbdmLMha0FLA+uhpIUAz9tWh3lXFSkPO+GOTZ9aYTm5+1iFbO77DwQMAf2eNMFRe/EUfulk2Q3RAZuIEaC32eW5S1LJghTdwvvE1gEeu8LNoiB/DRSQ3GG/l5ZT49j/3YlKXfYYZMe8504qFvNWS3M5MtMnrrPeLiBmXs0Nbft2lPDd5+Fdo3/LQ3bKkFiWq+xXDDn5m2vN5CP3p8tS6B5jHFTNcvr3eV1DLNdnq/UHSikDs0dwGvmXbRHiWY2NSK/vxnryjQ7SfA5MvvTICFeNQ=
