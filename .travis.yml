dist: xenial
before_install:
- bash install/helm_kubeval_install.sh
script:
- helm lint charts/todo-app
- mkdir manifests
- helm template charts/todo-app --output-dir manifests
- bash scripts/kubeval_validate_manifest.sh
after_success:
- mkdir distribution
- helm package charts/todo-app --destination distribution/
- helm repo index --url $GITHUB_PAGES_URL/todo-app-helm-chart ./distribution/
deploy:
  provider: pages
  skip_cleanup: true
  github_token: "$GITHUB_TOKEN"
  keep_history: true
  local_dir: "./distribution"
  on:
    branch: master
env:
  global:
    secure: MQaOjBaRdGzw/OuBxkcgFzR916HcMFG0dS8qCBtWFHYlV6VVWoaBOQ0xTcpk+c+OT7mY9H5pk1eknLUlVPuQ0I2FF2nDqoaITZCia5sEEpPUXfdRdMwy3WBT/jw2O5qsFOg47HaYElkh6OULg6LR0Pt1WXwulX7ajIP0Xix2vsbILX1SVOLH7GVF2ISaRtw19XfRgyZxWoapg3e4A1uGZPFjEByrtT84DeL6HDAlwMam2IwEAOrUdBqVsaW8DYZCHyrMUtzSNe6dOGODRp+I7h+AZcOuMmmEeW5maK/E7f1ZJIVPOkN4t214KRKbTBMF0GWJGl7q1cxtmBXqL7LRbnlmdPtlwvdGzCaEGQ+vi72k5m/7cMC9aQQiTmW0YdbrcxL9ai0osoyV6uv/uQlKbCjj75qw/yi6LfCOmD3j7z84lK2GHCpykmc+mGSvBEiSgcMfq+sKVVsJt8hxnKqmKlT9mcZObs9CsHoUqmOjBA3lZ564SxdmVelLJd9aqICrSWI36JTrLOExpDLDnuOOTlm/hzg0/A6NFJmhOGXX4cGrl0NK33vfBZKc+zf3ifcPrESn7U4LGEusxoBQXK9xWVo87flyorrb53wRaKPa3kyi3XICQ7N5TkE3IuxV4n+M4ZcE6BASSeoZsRwKs3vU2LupxXLA3PKNZ0PmntjYAT0=
