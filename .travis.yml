dist: xenial
before_install:
- bash install/helm_kubeval_install.sh
script:
- helm lint charts/todo-app
- mkdir manifests
- helm template charts/todo-app --output-dir manifests
- bash scripts/kubeval_validate_manifest.sh
after_success:
- mkdir distribution
- helm package charts/todo-app --destination distribution/
- helm repo index --url $GITHUB_PAGES_URL/todo-app-helm-chart ./distribution/
deploy:
  provider: pages
  skip_cleanup: true
  github_token: "$GITHUB_TOKEN"
  keep_history: true
  local_dir: "./distribution"
  on:
    branch: master
env:
  global:
    secure: UxcG60hj6nz4pISqFyYqpdiY3JVWj6EpVSLlDRRUFqXEluGFeeEbY4dN5ElhPI+ksVOLM/vz2AZDOBuiv/zCE0nIrApQE0sUYzyj+RW7Zf1GWI3A8T/1Wb8g4Yi72hCqfSUM4H3af/aO990Bdgan4/TdUnMt7BQShG7rqeLxN//GeXUrVYXKjf5l3Nh/ZWURGUOF6DuAPttAT2ElBcAUT7/oBqayRBNj6VeaNG2MRtR1GZ6J5AlhagEPXhIK0LGbXre0r1fo8olKWtGa0Imc5Lqo+pmh+s1Qtn/P2HM688UCwnj3vqKDk5VNGkrny3pxmf25f/nU4NnRNHnLajIGE4nv2V2Tgjx452lU1q1Wa90mH6GbLA/RXpA/zEUguOrnbmxpB244Y+9u+P4jdkvdwbLc+eSs2CzrpsuqE7Kf5tAn8vow6SFinoVUjQJO/NstsRkqGwxsYff3wi8Vx8TqO35aCT18SNqzHPb9T8BrHUIroPWMxpQYuoyljD75+BQxAsAYvc4IsluJtEUIlke9HWDr9mqRkckd4XAHa5r+bn6edNbAublw7BsskMfh0Gn8CLK2E7nv734eDDu5P3MU1JKnepsuW3w/urBDcRpH1RJ8s0iBoSgkbqeeycgq8CYY73MIxoLkOk3qDLkU2NdA4BMaEm3oe1Dxsy3HrqJz0kE=
