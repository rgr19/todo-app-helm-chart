dist: xenial
before_install:
- bash install/helm_kubeval_install.sh
script:
- helm lint charts/todo-app
- mkdir manifests
- helm template charts/todo-app --output-dir manifests
- bash scripts/kubeval_validate_manifest.sh
after_success:
- mkdir distribution
- helm package charts/todo-app --destination distribution/
- helm repo index --url $GITHUB_PAGES_URL/todo-app-helm-chart ./distribution/
deploy:
  provider: pages
  skip_cleanup: true
  github_token: "$GITHUB_TOKEN"
  keep_history: true
  local_dir: "./distribution"
  on:
    branch: master
env:
  global:
    secure: JHNNq7PjW85Jx5gQF1ljymKW3NLV3iRaxajIx/kPPKg6EBhJiieAv6GgtdWz4KKzSMwnjIM4MrfkEDEWzjZ9ht9OCiV5f6nxnHQWC0Nx43XqDrWHkKg1Z4IJIOVG20D9LgxUeJbgy/jgAkUrAO4QHstuapOxpb2aa1rpHTg9KG0Eh9WVeMCWyIm6iS+Db2J8xiyfQhc0Pt4oVroPHJFu37blzB8ozwD14+r3w32XKTzXNESqGVa8h0TF2Sz7Nf4ePr7oTZAjNEb3PeMBVzp/mdUds3ewMjHr1q9TX5m+GxEmGya9yHpGXMA0G2X2Q/175pF2Jqx7xYHEh55eMD1qTYKqGCcGaEgvIUg7Deck4eVg97NIRRJYNrmXlNz6La371hUyTZWL/wlL9CAMao1vGC/kUWhwt41/ldXJm9AzIvgBNo8EHedU5IIJT1FpE7lC+fP4w+wBB+QnCs5R+HXjlUw2cALplnGOjGj56TIm+QOHNgU/dNVQUA7AcW8m0JoyB3vgTfCo0kri7kpxDX+7aK3Mbz2mYAzDu8R3NfF3Luwd0To50AW1p6Tc/8Hy0txU4M4nmpsoICifQle4RJLkJJ6C/drykXtOtWyh5SK8O+RlgT7miTKIiDaj5mtM8lP+IcjYQQ3S/sZQXRJU9AJGfx84DB/3Ynjr24mrxozQeLY=
