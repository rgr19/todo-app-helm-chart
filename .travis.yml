dist: xenial
sudo: required
before_install:
- bash install/helm_kubeval_install.sh
script:
- helm lint charts/todo-app
- mkdir manifests
- helm template charts/todo-app --output-dir manifests
- bash scripts/kubeval_validate_manifest.sh
after_success:
- mkdir distribution
- helm package charts/todo-app --destination distribution/
- helm repo index --url $GITHUB_PAGES_URL/todo-app-helm-chart ./distribution/
deploy:
  provider: pages
  skip_cleanup: true
  github_token: "$GITHUB_TOKEN"
  keep_history: true
  local_dir: "./distribution"
  on:
    branch: master
env:
  matrix:
  - TRAVIS_SECURE_ENV_VARS=true
  global:
    secure: Pu7GAHOn6AAQiTafARzLRe6tLXF7ov0JwShAv3hvFPRN21KSB67w0ODHgxfbhYI8brWEnq/Oa1JmjsRcv4pwF2yzUn7ub4D1NaccDZ6whGD6jid2Rvw9Ho0bb6D6WB+pH/FkYOoijNOb3LIQ0/L0pBPyvqrbjQwsWvtBPMB/bQbh2xeidTPRJugpfMFpUNjvudMxiKgmK8HXsqiC52FlSCEd6H+8J7k4RzNhw1nGuYFbmWjMxHrVPy6ok1xeny5fvf2ROZezHHMN7Y1isaDNR/tHb81UeSJk1RdfrCqI6DtAjP5GGNqAtC24ia+oscahD8X6Xz/yZCRxrIDwORkWPt4pLIX5+/+fURb4hIvT7qsQOC2HHg9INTdNa1mbPpgj75Y3uTnxfW79Vj21VqyGlMFrNRSqUG0a4U3iJSZRn9ALddy0d9LAENS+iKekg8vZwM/kEYpkCtZ17N2sxRs9uqebOtpguyUdQmBiwIUIOBu2Ru0hvH6+StioIPrwJM+kW7RLNlT4uvDVGVrKZ10ZWish14zDpf7vrGEf05bA2x4xlU7R762wPD13PPsH1qhG3uGMvM/ov0Vr75wBQw95ls7PM+FCxMd1NFetN0G0RgV7tw7l/pWzxRAp2PG2WcUuEdbTBkfvUi2fD/6uICDleY/hHI3LyB/JKx8oHm3Jbdc=
