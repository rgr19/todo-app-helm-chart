dist: xenial
before_install:
- bash install/helm_kubeval_install.sh
script:
- helm lint charts/todo-app
- mkdir manifests
- helm template charts/todo-app --output-dir manifests
- bash scripts/kubeval_validate_manifest.sh
after_success:
- mkdir distribution
- helm package charts/todo-app --destination distribution/
- helm repo index --url $GITHUB_PAGES_URL/todo-app-helm-chart ./distribution/
deploy:
  provider: pages
  skip_cleanup: true
  github_token: "$GITHUB_TOKEN"
  keep_history: true
  local_dir: "./distribution"
  on:
    branch: master
env:
  global:
    secure: vVrhQypr3MgU1JeIs1MitoOKVOPaHx84sVwlzk/BFTaYt8Fjf7q3ioIsCRXyNYkNBUpG9H1nbUKaZq7UwAno+yBncFh7gmWKRubtyYX0ptah9kBRBiTRDgGWRYUyyC7fA6WtMX/35xRoKUVT1J+mKfx8TmXsTyeYhFmey5Py8n6jEtdnw3MPPCw04qbSA/7LKegCs92AxwJvwB6Ahf9bLWFs1AvHBek/lUGuc1CHWHyhP0SKHCEg25L85OjX0TEEGj7xWYPQr6potmaVEmcyzwl8voY2zF8d5FC2AS9qqSLe5zM6I4si94knGfFiLWAoeVWy086i25dk0fATDjxTwmEW3RvkAKEAshbX8iVPvW/tpvZsbYzraA72bq7FSc7MRJT7Pj8CXUr1gQf0yObWxkVSXUgbzlyorxNLu/xJzwERpeQgl7SiKKRslkMlmcveS5xIebqiO+oLgF2tdQzb1w/EZH8qOndtSb47GU/Tg7sBxFPQnI2Mfaj4CRlNN6j5rmifQ300hdESWaFJZuB2R+KnGsUdIyXEAeeUwtfdmeE7XRfk8ODk6CFA6V5l/4RaDuexoh85DPdDTb/8YcZVkreyAJYqHZpFpqDq8sNHHcwiaslKadfJalFKhytYwwuto/QRx7ONwPTZqta5ZR7VYtHD95nMIS9rCPNe39SNYg4=
