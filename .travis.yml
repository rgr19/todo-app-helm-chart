dist: xenial
before_install:
- bash install/helm_kubeval_install.sh
script:
- helm lint charts/todo-app
- mkdir manifests
- helm template charts/todo-app --output-dir manifests
- bash scripts/kubeval_validate_manifest.sh
after_success:
- mkdir distribution
- helm package charts/todo-app --destination distribution/
- helm repo index --url $GITHUB_PAGES_URL/todo-app-helm-chart ./distribution/
deploy:
  provider: pages
  skip_cleanup: true
  github_token: "$GITHUB_TOKEN"
  keep_history: true
  local_dir: "./distribution"
  on:
    branch: master
env:
  global:
    secure: psFss+oocLGBet8tfnUS+Xdao1SHqTTbw7izd5drKVMOI1QXj7gM6KmbRTVToGLYr0Myqb1EwaJm6EfzkckYqQfefZHXfwB7A9LpfFRi3sP+XK4FW18gmLiA64BXxjNArnKAnvaFPdQpaF9Yn7b040Rv+z6nRRuQFemGZhdQXp+t6WX3djn/kBsz+dLQBegWdXpf586fPClLKtfjKtzuogQJ693sMq+YCXBaXlM5rypaNHiIaOh5uQShZ5GNX/C02HI4P5O/j8rhT0R39zCwtVdJOufDyF0CE64EQIzer1m2Q/n5E1rkYrFG0Q/w564SevS4kmf4yLzjw3IU3WyNAPGfSep51XM3p331dA41vqth39ZjqURiL78ZX84uIDDcZxOkbiDJDu6k2H1adlQuCWeRP3Fuf6j/OKVddxIopBz5/MftgI7WoNrhIron4VEJ5y6yILywVLXM5BhpWvTzxoPLpOGImOeygb0Qui24imScV9a7OUxFL/6zQ96L/4RXpnzY6CbBEDpldloZ0x0LPdGMWqPzCnCyHdnte2rlF1oRqzh0XHKZW+ehOORTDoJnLFdrDEwkMFeSO8L7pcuaTAs9YhPr6XsSNDIpr3Q3Yw4DCC/BLhd++Ut6wz9Ba8lpLVz4PAH3PfHIfUfkDHRruAhCO/oMm/R3rmBfg5LF1EE=
