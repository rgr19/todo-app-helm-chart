dist: xenial
before_install:
- bash install/helm_kubeval_install.sh
script:
- helm lint charts/todo-app
- mkdir manifests
- helm template charts/todo-app --output-dir manifests
- bash scripts/kubeval_validate_manifest.sh
after_success:
- mkdir distribution
- helm package charts/todo-app --destination distribution/
- helm repo index --url $GITHUB_PAGES_URL/todo-app-helm-chart ./distribution/
deploy:
  provider: pages
  skip_cleanup: true
  github_token: "$GITHUB_TOKEN"
  keep_history: true
  local_dir: "./distribution"
  on:
    branch: master
env:
  global:
    secure: CDNDQcMg5jq4JfC8FkAXHbQ5osq7hzeqfwhspS8zXzVre7U9wUSTTfzb0zXCgEH6S7zc+X1l3Jils4Mtd/sKqQuVeWRTQjhNezzXqHBPaGYURGGTmk+iC1b42ZsM6d3lIifcOJP5hM6BL7EH0Zb6xJGQKKesoAXt+jq3ChzM8CwhgqnSTDKQip2fxg0lcPuCn1kUe2L8Ar9a1UcKNpRjqxkLa/mIwxkOD0jCd2ysIsAETT2JDeraTBj0+FiurGRzloL+E/z1WUAxiWhk54mxTWNqbUzxLZbwpuh4WH4w66WVBkY8yeIlVymshVfoAalKBY3U6bK0XvTK4/Dw9zcLiGr7ih1fYhv3WczE0qOQEF98X+QPUeWEiLRR2gwI8ouF90GhSrF8OWaNH7G8oHD9L0PACUWGStcFx1L+vbE1SQR+Nt3QdY559DCUNRcsfLIxTbL1tzz03P13PhrTqDD7Vhw8O9YPaQcVOwB5AcMIUuq9x5HZpEQra9jNeGR8BRXR84ne29SyUW8n+Fal8mfGILuJZoZEMoCJmZzet5uTxwEDnoZHDqHOJGOu6VlbRjk1SFHt3uD1CuOvTvT5jTVdO3XF8bzNjT0nJw+KpWhyORafJ67WAZQDlZIv7NEHoIf2ZYmH/T96C1pga8x+Gs5IQb8vPWw3OwQYVwZdVAl3ezg=
