dist: xenial
before_install:
- bash install/helm_kubeval_install.sh
script:
- helm lint charts/todo-app
- mkdir manifests
- helm template charts/todo-app --output-dir manifests
- bash scripts/kubeval_validate_manifest.sh
after_success:
- mkdir distribution
- helm package charts/todo-app --destination distribution/
- helm repo index --url $GITHUB_PAGES_URL/todo-app-helm-chart ./distribution/
deploy:
  provider: pages
  skip_cleanup: true
  github_token: "$GITHUB_TOKEN"
  keep_history: true
  local_dir: "./distribution"
  on:
    branch: master
env:
  global:
    secure: vk8oQb7bh3S/lbLWZGH2CyDAEuCA1dG+r5jbOjAqqR0mjIFOJ9k+6Z4FJXn46F5ragE3e4pdPF6cbUeSE0jdpUkygDUkYLV9SHBDnbV7OGgeONuhJn34uj0GaAepmNzAtvmc/ZdYEvYIvz831QhtqOgMsgBLfTuq+N6OFGFxRfglGThsiZZJ/TobIRXh5JiyqpfP6VcedHG93+wxhpq0wdqW66cZD6m38CtUtbAqFQ6NtP/qfeLut1YHVe6LAiKr9KAnChdkKLKzh4JCaydXXjbRBEUD9GAUgp3xWCoAVv0ZQ2A+PKsbQKCpufKk35Bbm8qQRNyC9wel1Jr+P0GuNnSAnuN58iCtEQsyDm9d0bi2m0YOQwvH9ic3wS9nHhayJk5qnZMgVmDk6wRC6jqTiHAMopnody6MOVyvcYaSpMa3I/swijCzc9aR42BqbFZW6CLJqgpbVZ7/8mK8/8175UNDqfaotP2U3WiBmVZVatpWliLoAx+n3rS6gDLZjYMCUQpdj/myNPGOGNAm76e7s0lXeN9KpLKLZZGZDVPf3YU6rTJ6iZ7UCFj1URQS46fl0YXwk0RdIcgJKddAkvlMnyBuUwtiCnWy9Nq/h6h0GkpKxc85SvWcl9vG1LjdBc1edhA62BCUwzC2GDvVpsi6e/NjJw3aikpaTnOl0O40qY8=
