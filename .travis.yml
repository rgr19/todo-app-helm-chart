dist: xenial
before_install:
- bash install/helm_kubeval_install.sh
script:
- helm lint charts/todo-app
- mkdir manifests
- helm template charts/todo-app --output-dir manifests
- bash scripts/kubeval_validate_manifest.sh
after_success:
- mkdir distribution
- helm package charts/todo-app --destination distribution/
- helm repo index --url $GITHUB_PAGES_URL/todo-app-helm-chart ./distribution/
deploy:
  provider: pages
  skip_cleanup: true
  github_token: "$GITHUB_TOKEN"
  keep_history: true
  local_dir: "./distribution"
  on:
    branch: master
env:
  global:
    secure: LES8sEOzNdDkmC+bhcit8rmct0ULslGqYD0/YDQ79m8GNRk/KTUy4Z8NxZCY5PvYcPwCoLxXLl+GImMx7rtXj/YOQubjaOVE8Ws6uusBYuo5aRgKVfZABo/y7mkWiYYROPbuTZxEFmX7PSim3k3ecjVkSg7qVYVvm9hC+/cWSB0o63DzAo3pScywpwD25rKQH/I0gHMbEJN9zCidR0LSG7j7mfoMFUCxnfciFgj8DT2K/+qPy7n02gH/tG9ypCaLAaf1GqsqvySZDuPyOk074hyRuJVlvb7VjWPcO/wkAQza0ubJ9THri5a3i4nFzIjpUMZjdalq3wDiFJg9WXzmbK4EVzn2MkjdXH4/+vqLVK3VQ58VTK2uKlKIPS7aDaelAuR4ZgqVm15IQRQAO8fA4XTdDFxi90lzc5PKwz+hAR8hhp6mGitIVcKbZxIrdDjIEJ0UX+7GAl+8wOKzk5OFHOk6CXwc0cBDTC9DjmTLWZO14H5s3jgCx+OiY8YJn/j88NjBIQX7cjEyYQXnOrE1Y766fQ0T/jNzwDRFWb6FqVSRM3qE9kwjBvFyff+mkZgk2iqke6VEL/aZIik77wVjpgfJj1ZXC4dXaXnKNl/CO511FjFvqxtPCyYA3IdKMzeMegZeuhMkWKtezJnVqjAV9msqrbPiMYQABYTC4WojE6M=
