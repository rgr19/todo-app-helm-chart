dist: xenial
before_install:
- bash install/helm_kubeval_install.sh
script:
- helm lint charts/todo-app
- mkdir manifests
- helm template charts/todo-app --output-dir manifests
- bash scripts/kubeval_validate_manifest.sh
after_success:
- mkdir distribution
- helm package charts/todo-app --destination distribution/
- helm repo index --url $GITHUB_PAGES_URL/todo-app-helm-chart ./distribution/
deploy:
  provider: pages
  skip_cleanup: true
  github_token: "$GITHUB_TOKEN"
  keep_history: true
  local_dir: "./distribution"
  on:
    branch: master
env:
  matrix:
  - TRAVIS_SECURE_ENV_VARS=true
  global:
    secure: XbWgh9hcWLnZXNsCvcHVGayUgBbePzwM1sn9FUjEN6OULjDZq16dFCn4kkto4iiFx1TH3Rf52rgZLo3Rqh222sSg4TFaiLncQLmnIJj7OoD9NBvM+Mga+PL6nU1DGfHDtWh3FljDqMYY3ob3hXeirJOD6jgQNz67+bWAX6tFGs8e5/9SpN0zQfWYKTjyJCqMzZW1ztp8I7CRPGhQgcmJLj4DezJRYByqXQiZV7s+FCWzWErOM727f16O2DlcSOATFI/BvHrmB/5ULslsL6P43ZURIoLCDUSixWtlIuw0nmzsPHg9WzeXM69UE4X6T2+IGVXjieSy/vtlJyXGss186sDCuGOflC329kNQCQuGqVo4N4e9tNSIk9rvcIZNoO1HdFROVK6QJcPasKE27GcV4Dsb89IG3bHgOJbZkArD5/UOy3h+ya4h+55kQjllR0A4fK7uqnEO3EpwgqmIYOwCmM8mR7wNbZdC+QAHzz6oPlzqFtsSy76b2jaqq4+wzZlunmR4FpsBF9RzAeMrjMwVbPTZ3u2dCJ/cDTIZdYjc0SJ/oy4JZLu6jzmDfipox7cjLoPGXLMPjhLx8o9o+zw8QwHlX5Cpi9VFA49CEQNojbGUMO5VxjX2UIfBVD9zWidaqAPmPkVkra06fFmx1iQzu2sforFiPYnEZYQdxw0Etr0=
